<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>懒加载测试页面</title>
    <style>
        /* 引入懒加载样式 */
        .tool-details {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
            margin: 8px 0;
            opacity: 0;
            visibility: hidden;
        }

        .tool-details-placeholder {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
            margin: 8px 0;
            opacity: 0;
            visibility: hidden;
            background: #f8f9fa;
            border-radius: 4px;
            padding: 8px;
            text-align: center;
            color: #6b7280;
            font-size: 14px;
        }

        .tool-details-checkbox {
            display: none;
        }

        .tool-details-checkbox:checked + .tool-details-placeholder {
            max-height: 60px;
            opacity: 1;
            visibility: visible;
            transition: all 0.3s ease-in;
        }

        .tool-details-checkbox:checked + .tool-details-placeholder + .tool-details {
            max-height: 1000px;
            opacity: 1;
            visibility: visible;
            transition: all 0.3s ease-in;
        }

        .tool-details-checkbox:checked + .tool-details-placeholder + .tool-details {
            display: block;
        }

        .tool-details-checkbox:checked + .tool-details-placeholder {
            display: none;
        }

        .loading-spinner {
            display: inline-block;
            animation: spin 1s linear infinite;
            margin-right: 8px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .tool-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 8px;
            background: #f8f9fa;
            border-radius: 4px;
            margin: 4px 0;
            cursor: pointer;
        }

        .tool-name {
            font-weight: 500;
            color: #374151;
        }

        .tool-details-toggle {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 20px;
            height: 20px;
            cursor: pointer;
            user-select: none;
            transition: all 0.2s ease;
            flex-shrink: 0;
        }

        .tool-details-toggle::after {
            content: "▼";
            font-size: 12px;
            color: #6b7280;
            transition: all 0.2s ease;
            line-height: 1;
        }

        .tool-details-toggle:hover::after {
            color: #374151;
        }

        .tool-details-checkbox:checked + .tool-details-placeholder + .tool-details + .tool-header .tool-details-toggle::after,
        .tool-details-checkbox:checked ~ .tool-header .tool-details-toggle::after {
            transform: rotate(180deg);
        }

        .result-box {
            border: 1px solid #e5e7eb;
            border-radius: 6px;
            margin: 8px 0;
            background: white;
        }

        pre {
            background: #f3f4f6;
            padding: 12px;
            border-radius: 4px;
            overflow-x: auto;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <h1>懒加载测试页面</h1>
    <p>点击工具名称展开查看详情，体验懒加载效果。</p>

    <!-- 测试工具结果 1 -->
    <div className="result-box" id="tool-result-test-1">
        <div className="tool-header">
            <div className="tool-name">🛠 `memory read_graph` (success)</div>
            <label for="tool-result-test-1-checkbox" className="tool-details-toggle"></label>
        </div>
        <input type="checkbox" id="tool-result-test-1-checkbox" className="tool-details-checkbox" />
        
        <div className="tool-details-placeholder">
            <div className="loading-spinner">⏳</div>
            <div>Loading tool details...</div>
        </div>
        
        <div className="tool-details">
            <pre><code>```json arguments
{}

```

```json output_result
{
  "entities": [
    {
      "type": "entity",
      "entityType": "Person",
      "name": "MCP Wang",
      "observations": [
        "Student ID: 2401210477",
        "Email: mcptest0606@gmail.com",
        "Address: Building 1, Unit 2, Haidian Road Community",
        "Phone: 13812345678",
        "Major: Electronic Information Major",
        "Department: Engineering and Data Technology Department",
        "Hobbies: Programming, Reading, English",
        "Level of English: Scored 88 in the National Postgraduate Entrance Examination English Test, 6 in IELTS"
      ]
    }
  ]
}
```</code></pre>
        </div>
    </div>

    <!-- 测试工具结果 2 -->
    <div className="result-box" id="tool-result-test-2">
        <div className="tool-header">
            <div className="tool-name">🛠 `filesystem read_file` (success)</div>
            <label for="tool-result-test-2-checkbox" className="tool-details-toggle"></label>
        </div>
        <input type="checkbox" id="tool-result-test-2-checkbox" className="tool-details-checkbox" />
        
        <div className="tool-details-placeholder">
            <div className="loading-spinner">⏳</div>
            <div>Loading tool details...</div>
        </div>
        
        <div className="tool-details">
            <pre><code>```json arguments
{
  "path": "workspace/schedule.xlsx"
}
```

```json output_result
{
  "content": "Excel file content with course schedule data...",
  "size": 15678,
  "modified": "2024-01-15T10:30:00Z"
}
```</code></pre>
        </div>
    </div>

    <!-- 测试工具结果 3 -->
    <div className="result-box" id="tool-result-test-3">
        <div className="tool-header">
            <div className="tool-name">❌ `python-execute` (error in tool call)</div>
            <label for="tool-result-test-3-checkbox" className="tool-details-toggle"></label>
        </div>
        <input type="checkbox" id="tool-result-test-3-checkbox" className="tool-details-checkbox" />
        
        <div className="tool-details-placeholder">
            <div className="loading-spinner">⏳</div>
            <div>Loading error details...</div>
        </div>
        
        <div className="tool-details">
            <pre><code>```python
import pandas as pd
df = pd.read_excel('schedule.xlsx')
print(df.head())
```

```json error_message
ModuleNotFoundError: No module named 'pandas'
```</code></pre>
        </div>
    </div>

    <script>
        // 懒加载JavaScript逻辑
        document.addEventListener('DOMContentLoaded', function() {
            const checkboxes = document.querySelectorAll('.tool-details-checkbox');
            
            checkboxes.forEach(function(checkbox) {
                checkbox.addEventListener('change', function() {
                    if (this.checked) {
                        lazyLoadToolDetails(this);
                    } else {
                        hideToolDetails(this);
                    }
                });
            });
        });
        
        function lazyLoadToolDetails(checkbox) {
            const toolResultId = checkbox.id.replace('-checkbox', '');
            const placeholder = document.querySelector(`#${toolResultId} .tool-details-placeholder`);
            const details = document.querySelector(`#${toolResultId} .tool-details`);
            
            if (!placeholder || !details) return;
            
            // 显示加载占位符
            showPlaceholder(placeholder);
            
            // 模拟加载延迟
            setTimeout(function() {
                hidePlaceholder(placeholder);
                showDetails(details);
            }, 500);
        }
        
        function showPlaceholder(placeholder) {
            placeholder.style.maxHeight = '60px';
            placeholder.style.opacity = '1';
            placeholder.style.visibility = 'visible';
        }
        
        function hidePlaceholder(placeholder) {
            placeholder.style.maxHeight = '0';
            placeholder.style.opacity = '0';
            placeholder.style.visibility = 'hidden';
        }
        
        function showDetails(details) {
            details.style.maxHeight = '1000px';
            details.style.opacity = '1';
            details.style.visibility = 'visible';
        }
        
        function hideToolDetails(checkbox) {
            const toolResultId = checkbox.id.replace('-checkbox', '');
            const placeholder = document.querySelector(`#${toolResultId} .tool-details-placeholder`);
            const details = document.querySelector(`#${toolResultId} .tool-details`);
            
            if (placeholder) {
                hidePlaceholder(placeholder);
            }
            
            if (details) {
                details.style.maxHeight = '0';
                details.style.opacity = '0';
                details.style.visibility = 'hidden';
            }
        }
    </script>
</body>
</html>
